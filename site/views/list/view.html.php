<?php/* *************************************************************************************Title          prayer Component for JoomlaAuthor         Mike LeeperLicense        This program is free software: you can redistribute it and/or modify               it under the terms of the GNU General Public License as published by               the Free Software Foundation, either version 3 of the License, or               (at your option) any later version.               This program is distributed in the hope that it will be useful,               but WITHOUT ANY WARRANTY; without even the implied warranty of               MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the               GNU General Public License for more details.               You should have received a copy of the GNU General Public License               along with this program.  If not, see <http://www.gnu.org/licenses/>.Copyright      2006-2014 - Mike Leeper (MLWebTechnologies) ****************************************************************************************No direct access*/defined('_JEXEC') or die('Restricted access');class CWMPrayerViewList extends JViewLegacy{	/** @var  CWMPrayerSitePrayer */	protected $prayer;	/** @var  string */	protected $title;	/** @var  string */	protected $intro;	/** @var  string */	protected $results;	protected $sort;	protected $limit;	protected $limitstart;	protected $moderate;	protected $total;	protected $totalresults;	protected $action;	public function display($tpl = null)	{		$this->prayer = new CWMPrayerSitePrayer;		$pc_rights = $this->prayer->intializePCRights();		$app = JFactory::getApplication();		$uri = JFactory::getURI();		$user = JFactory::getUser();		$lang = Jfactory::getLanguage();		$lang->load('com_cwmprayer', JPATH_SITE);		$limit = $app->getUserStateFromRequest('global.list.limit', 'limit', $this->prayer->pcConfig['config_rows'], 'int');		if (empty($limitstart))		{			$limitstart = 0;		}		if (isset($_REQUEST['limitstart']))		{			$limitstart = JRequest::getVar('limitstart', null, 'request', 'int');		}		if (isset($_POST['sort']))		{			$sort = JRequest::getVar('sort', null, 'post', 'int');		}		else		{			$sort = 99;		}		if (isset($_POST['searchword']))		{			$searchword = JRequest::getVar('searchword', null, 'post', 'string');		}		else		{			$searchword = "";		}		if (isset($_REQUEST['searchrequester']))		{			$searchrequester = JRequest::getVar('searchrequester', null, 'request', 'string');		}		else		{			$searchrequester = "";		}		if (isset($_REQUEST['searchrequesterid']))		{			$searchrequesterid = JRequest::getVar('searchrequesterid', null, 'request', 'int');		}		else		{			$searchrequesterid = "";		}		/** @var \CWMPrayerModelPrayer $model */		$model = JModelLegacy::getInstance('Prayer', 'CWMPrayerModel');		$results = $model->getData($sort, $searchword, $searchrequester, $searchrequesterid);		$total = $model->getTotal($sort, $searchword, $searchrequester, $searchrequesterid);		$totalresults = $model->getTotalData();		$this->prayer->pcConfig['config_allowed_plugins'] = preg_split('/[,]/', $this->prayer->pcConfig['config_allowed_plugins'], -1, PREG_SPLIT_NO_EMPTY);		// Set pathway information		$this->action = $uri->toString();		$this->title = JText::_('CWMPRAYERTITLE');		$this->intro = nl2br(JText::_('CWMPRAYERLISTINTRO'));		$this->results = $results;		$this->totalresults = $totalresults;		$this->total = $total;		$this->sort = $sort;		$this->limit = $limit;		$this->limitstart = $limitstart;		$this->moderate = $this->prayer->pc_rights->get('pc.moderate');		parent::display($tpl);	}}