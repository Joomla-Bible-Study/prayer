<?php/** * @package     Joomla.Administrator * @subpackage  COM_PRAYER * * @copyright   Copyright (C) 2005 - 2012 Open Source Matters, Inc. All rights reserved. * @license     GNU General Public License version 2 or later; see LICENSE.txt */defined('_JEXEC') or die;class PrayerModelReq extends JModelAdmin{	/**	 * The prefix to use with controller messages.	 *	 * @var    string	 * @since  1.6	 */	protected $text_prefix = 'COM_PRAYER';	/**	 * The type alias for this content type.	 *	 * @var    string	 * @since  3.2	 */	public $typeAlias = 'com_prayer.req';	/**	 * The context used for the associations table	 *	 * @var    string	 * @since  3.4.4	 */	protected $associationsContext = 'com_prayer.item';	/**	 * Batch copy/move command. If set to false, the batch copy/move command is not supported	 *	 * @var  string	 */	protected $batch_copymove = 'category_id';	public function getTable($type = 'Prayer', $prefix = 'Table', $config = [])	{		return JTable::getInstance($type, $prefix, $config);	}	public function getForm($data = [], $loadData = true)	{		JForm::addFieldPath(JPATH_ADMINISTRATOR . '/components/com_users/models/fields');		$form = $this->loadForm('com_prayer.req', 'req', ['control' => 'jform', 'load_data' => $loadData]);		if (empty($form))		{			return false;		}		return $form;	}	protected function populateState()	{		parent::populateState();		$input = JFactory::getApplication()->input;		$user = JFactory::getUser();		$this->setState('user.id', $user->get('id'));		$edit = $input->get('edit', true);		$this->setState('edit', $edit);		$cid = $input->get('cid');		$this->setState('id', $cid[0]);	}	protected function loadFormData()	{		if (empty($data))		{			$data = $this->getItem();		}		return $data;	}	protected function prepareTable($table)	{		$date = JFactory::getDate();		$user = JFactory::getUser();		$table->title = htmlspecialchars_decode($table->title, ENT_QUOTES);		$table->alias = JApplication::stringURLSafe($table->alias);		if (empty($table->alias))		{			$table->alias = JApplication::stringURLSafe($table->title);		}		if (empty($table->id))		{			// Set the values			// Set ordering to the last item if not set			if (empty($table->ordering))			{				$db = JFactory::getDbo();				$db->setQuery('SELECT MAX(ordering) FROM #__prayer');				$max = $db->loadResult();				$table->ordering = $max + 1;			}			else			{				// Set the values				$table->modified = $date->toSql();				$table->modified_by = $user->get('id');			}			// Increment the content version number.			$table->version++;		}	}	protected function getReorderConditions($table)	{		$condition = array();		$condition[] = 'category = ' . (int) $table->category;		return $condition;	}}