<?php/** * @package     Joomla.Administrator * @subpackage  COM_CWMPRAYER * * @copyright   Copyright (C) 2005 - 2012 Open Source Matters, Inc. All rights reserved. * @license     GNU General Public License version 2 or later; see LICENSE.txt */defined('_JEXEC') or die;class CWMPrayerModelLink extends JModelAdmin{	protected $text_prefix = 'com_cwmprayer';	public function getTable($type = 'Links', $prefix = 'PrayerTable', $config = array())	{		return JTable::getInstance($type, $prefix, $config);	}	public function getForm($data = array(), $loadData = true)	{		$app = JFactory::getApplication();		$form = $this->loadForm('com_cwmprayer.link', 'link', array('control' => 'jform', 'load_data' => $loadData));		if (empty($form))		{			return false;		}		return $form;	}	protected function populateState()	{		parent::populateState();		$input = JFactory::getApplication()->input;		$user = JFactory::getUser();		$this->setState('user.id', $user->get('id'));		$edit = $input->get('edit');		$this->setState('edit', $edit);		$planid = $input->get('cid');		$this->setState('id', $planid[0]);	}	protected function loadFormData()	{		if (empty($data))		{			$data = $this->getItem();		}		return $data;	}	protected function prepareTable($table)	{		$date = JFactory::getDate();		$user = JFactory::getUser();		$table->name = htmlspecialchars_decode($table->name, ENT_QUOTES);		$table->alias = JApplicationHelper::stringURLSafe($table->alias);		if (empty($table->alias))		{			$table->alias = JApplicationHelper::stringURLSafe($table->name);		}		if (empty($table->id))		{			// Set the values			// Set ordering to the last item if not set			if (empty($table->ordering))			{				$db = JFactory::getDbo();				$db->setQuery('SELECT MAX(ordering) FROM #__cwmprayer_links');				$max = $db->loadResult();				$table->ordering = $max + 1;			}			else			{				// Set the values				$table->modified = $date->toSql();				$table->modified_by = $user->get('id');			}			// Increment the content version number.			$table->version++;		}	}}