<?php/** * @package     Joomla.Administrator * @subpackage  COM_CWMPRAYER * * @copyright   Copyright (C) 2005 - 2012 Open Source Matters, Inc. All rights reserved. * @license     GNU General Public License version 2 or later; see LICENSE.txt */defined('_JEXEC') or die;class CWMPrayerModelDevotion extends JModelAdmin{	/**	 * The prefix to use with controller messages.	 *	 * @var    string	 * @since  1.6	 */	protected $text_prefix = 'COM_CWMPRAYER';	/**	 * The type alias for this content type.	 *	 * @var    string	 * @since  3.2	 */	public $typeAlias = 'com_cwmprayer.devotion';	/**	 * The context used for the associations table	 *	 * @var    string	 * @since  3.4.4	 */	protected $associationsContext = 'com_cwmprayer.item';	/**	 * Batch copy/move command. If set to false, the batch copy/move command is not supported	 *	 * @var  string	 */	protected $batch_copymove = 'category_id';	public function getTable($type = 'Devotion', $prefix = 'PrayerTable', $config = [])	{		return JTable::getInstance($type, $prefix, $config);	}	public function getForm($data = [], $loadData = true)	{		JForm::addFieldPath(JPATH_ADMINISTRATOR . '/components/com_users/models/fields');		$form = $this->loadForm('com_cwmprayer.devotion', 'devotion', ['control' => 'jform', 'load_data' => $loadData]);		if (empty($form))		{			return false;		}		return $form;	}	public function save($data)	{		return parent::save($data);	}	protected function loadFormData()	{		$app = JFactory::getApplication();		// Check the session for previously entered form data.		$data = $app->getUserState('com_cwmprayer.edit.devotion.data', array());		if (empty($data))		{			$data = $this->getItem();			// Prime some default values.			if ($this->getState('contact.id') == 0)			{				$data->set('catid', $app->input->get('catid', $app->getUserState('com_cwmprayer.devotions.filter.category_id'), 'int'));			}		}		$this->preprocessData('com_cwmprayer.devotion', $data);		return $data;	}	protected function prepareTable($table)	{		$date = JFactory::getDate()->toSql();		$user = JFactory::getUser();		$table->name = htmlspecialchars_decode($table->name, ENT_QUOTES);		if (empty($table->id))		{			// Set the values			// Set ordering to the last item if not set			if (empty($table->ordering))			{				$db = JFactory::getDbo();				$db->setQuery('SELECT MAX(ordering) FROM #__cwmprayer_devotions');				$max             = $db->loadResult();				$table->ordering = $max + 1;			}			else			{				// Set the values				$table->modified    = $date->toSql();				$table->modified_by = $user->get('id');			}			// Increment the content version number.			$table->version++;		}	}//	protected function getReorderConditions($table)//	{//		$condition   = [];//		$condition[] = 'catid = ' . (int) $table->category;////		return $condition;//	}}